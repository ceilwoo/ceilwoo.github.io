<?php/*** bbs帖子列表*  * @param $id comment id* @param $value comment content* @param $content_url 帖子的查看页面的链接* @param $view 评论类型:recent最新的评论;essential是精华帖子* @param $show_project* @param $show_top_logo* @param $orderby  排序段* * @package View.Comment* @author kuncai*/?><?php echo $html->css('comment') ?><?phpif (!isset($show_project)) $show_project=false;if (!isset($show_top_logo)) $show_top_logo=true;?><div  class="discuss"><!-- Option --><div style="margin-bottom:5px;"><form action="<?php echo $html->url('/'.$project_code.'/comments/add'); ?>" target="contents"><table><tr><td><?php if($project['id'] != 0 ) echo $html->submit(t('New thread','/bbs'),array('id'=>"new_comment_button",'class'=>'tapd-button')); ?></td><td><div style="font-size:12px;">&nbsp; &nbsp;<a href="<?php echo $myHtml->url('/comments/index/recent/')?><?php if(isset($set_id)) echo $set_id ?>"<?php if($view=='recent') echo 'style="font-weight: bold"'; ?> > <?php echo t('Recently','/bbs') ?></a>[<a href="<?php echo $myHtml->url('/comments/index/recent/')?>?orderby=created" <?php if($view=='recent' && $orderby=='created') echo 'style="font-weight: bold"'; ?>><?php echo t('Topic','/bbs');?></a>/<a href="<?php echo $myHtml->url('/comments/index/recent/')?>?orderby=modified" <?php if($view=='recent' && $orderby=='modified') echo 'style="font-weight: bold"'; ?>><?php echo t('Reply','/bbs');?></a>] |<a href="<?php echo $myHtml->url('/comments/index/essential/')?><?php if(isset($set_id)) echo $set_id ?>" <?php if($view=='essential') echo 'style="font-weight: bold"'; ?>><?php echo t('Essential','/bbs') ?></a> </div></td></tr></table></form></div><!-- end Option --><?php echo $this->renderElement('pager') ?><!-- comment list --><ul id="subjects"><?php$url = '/comments/view/';?><li class="whatsup">* <?php echo $html->link(t('What’s up?','/bbs') , $content_url, array('target'=>'contents')) ?></li><?php $i=1;foreach($comments as $row):foreach($row as $comment):$project_name = null;if (isset($comment['entry_type'])&& ($show_project)){switch (strtolower($comment['entry_type'])){case "project":$proj_id  = $comment['entry_id'];break;case "twitter":list($proj_id, $twitter_id) = explode(":", $comment['entry_id']);break;default:}$project_name = get_project_name($proj_id);}?><?php $link_href = '';if(isset($comment['project_pretty_name'])){$link_href = $this->webroot.$comment['project_pretty_name'].'/goals/view/'.$comment['id'].'?iframe=ture';}else{$link_href = $myHtml->url($url.$comment['id'].'/?read=1');}?><li <?php if(isset($real_count)&&($i>$real_count)) echo "class='others'"; ?>><a class="blank_link" title="<?php echo t('Click here to view in a new page.')?>" href="<?php echo $link_href ?>" target="_blank"><span style="padding:0px 7px">&nbsp;</span></a><!--set url for goal list.   frankychen--><?php if(isset($comment['project_pretty_name'])){ ?><a href="<?php echo $link_href;?>" target="contents"><?php }else{ ?><a href="<?php echo $link_href;?>" target='contents'><?php } ?><?php if(isset($project_name)) echo '['.$project_name.'] '; ?><?php if(!(isset($real_count)&&($i>$real_count))): ?><?php if(isset($comment['top']) && $show_top_logo ){ if($comment['top'] == 1) echo '<font color="red">[顶]</font>';} ?><?php if(isset($comment['essential']) && $show_top_logo ){ if($comment['essential'] == 1) echo '[精]';} ?><?php endif ?><?php echo $comment['title'] ?></a><span>[<?php echo $comment['read_count'] ?>/<?php echo $comment['reply_count'] ?>]- <?php echo $comment['created_by'] ?></span></li><?php $i++; endforeach;endforeach ?></ul><!-- end comment list --><!--  --><?php echo $this->renderElement('pager') ?></div><script>$(document).ready(function(){try{document.domain = 'oa.com';}catch(e){}});</script>
